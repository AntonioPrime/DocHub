# ArchOps концепция
DocHub позволяет описывать архитектуру через манифесты. 
Манифест это структурированный файл, в котором описываются архитектурные компоненты 
и связи между ними. 

Поддерживаются два формата файлов: JSON и YAML. Предпочтительным является формат yaml. 
Этот формат поддерживает комментарии, что существенно упрощает описание архитектуры.

Пример манифеста (yaml):
```yaml
# Манифест описывающий сам DocHub
components:  # Архитектурные компоненты
  dochub$front:   # Идентификатор компонента
    title: Интерфейс пользователя   # Название компонента
    entity: component               # Сущность компонента из PlantUML (https://plantuml.com/ru/deployment-diagram)
contexts:   # Контексты представления архитектурных компонентов
docs:       # Документы
  dochub_conception: # Идентификатор документа
    icon: lightbulb_outline     # Иконка, которы будет отображаться в дереве навигации
    location: DocHub/Концепция  # Размещение документа в дереве навигации
    description: Концепция управления архитектурой  # Краткое описание сути документа
    type: markdown              # Тип документа (OpenAPI / markdown / PlantUML)
    subjects:                   # К какой сущности документ имеет отношения
      - dochub$front            # Идентификатор сущности
    source: ../docs/archops.md  # Путь к документу (относительный)
```


## Компоненты (components)
Компоненты являются базовыми сущностями манифестов. Манифест компонента описывает
его свойства: контексты представления, взаимосвязи с другими компонентами и т.д.

Пример описания компонента в манифесте:
```yaml
title: 3. Web app servers # Название компонента
entity: collections # Представление компонента на схеме (https://plantuml.com/ru/deployment-diagram)
technologies:   # Использованные технологии в компоненте
  - PHP
  - Symfony
presentations:  # Представления компонента
  - contexts:   # В каких контекстах компонент представлен
      - company$general
      - company$application
    requires:   # Зависимости компонента от других компонентов
      - id: company$services # Идентификатор компонента
      - id: company$full_text_searcher
      - id: company$cache_service
      - id: company$database
      - id: company$queue
      - id: amazon$data_firehouse
      - id: company$load_balancer
        contract: publicapi # Зависимости может содержать информацию о контракте
aspects: # Какие аспекты компонент реализует
  - company$auth # Идентификатор аспекта
```

### Контексты
Представление архитектуры имеет смысл в определенном контексте. Например, 
в контексте уровня корпоративной архитектуры не имеет смысла отображать 
на схеме БД. В то же время, в контексте архитектуры данных нет смысла 
отображать компоненты управления трафиком.

Таким образом, при описании компонентов архитектуры указывается контекст
его представления.

```javascript
"components": {
    ...
    "pao_kit@auth": {
        ...
        "contexts" : ["global", "shop", "shop/c2c"]
        ...
    }
}

```

Контексты могут иметь иерархию. В данном примере контекст "с2с"
подчинен контексту "shop". Таким образом явно указывается, что 
контекст "с2с" является частью контекста "shop". 

Развернутое описание контекстов производится в секции манифеста 
"contexts".

```javascript
    "contexts": {
        ...
        "global": {
            "title": "ООО Кит"
        },
        "shop/c2c": {
            "title": "Услуги физлицам"
        }
        ...
    }
```

Развернутое описание является необязательным. В данном примере контексту 
"global" определен заголовок "ООО КИТ". Контексту "shop/c2c" определен 
заголовок "Услуги физлицам".

На основании иерархии контекстов строится меню навигации "Архитектура/Контексты".
