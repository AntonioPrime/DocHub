docs:
  # Описываем параметризующую форму для табличного документа
  dochub.formen.simple:
    type: formen-form
    # Описываем JSONSchema параметров
    schema:
      title: Параметры отбора
      type: object
      properties:
        checkbox:
          title: Пример
          type: boolean
        # Определим одно поле для отбора по направлению связи
        direction:
          title: Направление связи
          type: string
          enum:
            - "*"
            - "<--"
            - "-->"
            - "<-->"
            - "<-"
    # Ссылка на объект управления
    subject: "@document/dochub.table.select"
    # Готовим данные для заполнения формы
    source: >
      (
        {
          "data": {
              "direction": "<-" /* По умолчанию отбираем все связи */,
              "checkbox": true
          }
        }
      )

  # Описываем табличный документ, который будет работать по параметрам
  dochub.table.select:        
    type: table
    headers:
      - value: from
        text: Система 1
        sortable: true
        align: left
        width: 20%
        link: link-from
      - value: to
        text: Система 2
        sortable: true
        align: left
        width: 20%
        link: link-to
      - value: direction
        text: Связь
        sortable: true
        align: center
        width: 5%
      - value: title
        text: Описание
        sortable: true
        align: left
      - value: contract
        text: Контракт
        sortable: true
        align: left
        link: link-contract
    # JSONata запрос к архитектуре в который передаются параметры Формы
    source: >  
      (
        $MANIFEST := $;
        /* Получаем переданный формой параметр */
        $DIRECTION := $params.direction;
        $distinct([components.$spread().(
            $COMPONENT := $;
            $COMPONENT_ID := $keys()[0];
            /* Отбираем по переданному параметру */
            $.*.links[(direction = $DIRECTION) or ($DIRECTION="*")].{
                "from": $COMPONENT.*.title,
                "link-from": "/architect/components/" & $COMPONENT_ID,
                "to": id ? $lookup($MANIFEST.components, id).title : id,
                "link-to": "/architect/components/" & id,
                "contract": contract ? $lookup($MANIFEST.docs, contract).location : contract,
                "link-contract": "/docs/" & contract,
                "title": title,
                "direction": direction
            };
        )])^(from)
      )      

    